- hosts: localhost
  connection: local

  tasks:
    - name: link files
      file:
        state: link
        src: "{{ playbook_dir }}/files/{{ item.src }}"
        path: ~/{{ item.dest }}
      loop:
        - src: database
          dest: .database
        - src: devcontainer
          dest: .devcontainer
        - src: profile.d
          dest: .profile.d
        - src: tmux.conf
          dest: .tmux.conf
        - src: profile.bash
          dest: .bash_profile
        - src: eslintrc.yml
          dest: .eslintrc.yml

    - name: put files
      template:
        src: "{{ playbook_dir }}/templates/{{ item.src }}"
        dest: ~/{{ item.dest }}
      loop:
        - src: gitconfig
          dest: .gitconfig

    - name: install brew packages
      homebrew:
        name: "{{ item }}"
      loop:
        - bash-completion
        - beeftornado/rmtree/brew-rmtree
        - ffmpeg
        - git
        - git-lfs
        - gnupg
        - go
        - graphviz
        - imagemagick
        - jq
        - make
        - mtr
        - nodejs
        - python3
        - tmux
        - wget
        - yarn

    - name: install pip packages
      pip:
        name: "{{ item }}"
        virtualenv: ~/.venv
      loop:
        - ansible<2.8.0
        - awscli
        - aws-sam-cli
        - online-judge-tools
