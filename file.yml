- name: create directory
  file:
    state: directory
    path: ~/{{ item }}
    mode: 0700
  loop:
    - .ssh
    - .gnupg
    - .config/fish

- name: create files
  template:
    src: "{{ playbook_dir }}/files/{{ item.src }}"
    dest: ~/{{ item.dest }}
  loop:
    - src: prefix.fish
      dest: .prefix.fish
    - src: profile.zsh
      dest: .zprofile
    - src: gitconfig
      dest: .gitconfig
    - src: gpg-agent.conf
      dest: .gnupg/gpg-agent.conf

- name: link files
  file:
    state: link
    src: "{{ playbook_dir }}/files/{{ item.src }}"
    dest: ~/{{ item.dest }}
    force: yes
    follow: no
  loop:
    - src: npmrc
      dest: .npmrc
    - src: tmux.conf
      dest: .tmux.conf
    - src: prettierrc.yml
      dest: .prettierrc.yml
    - src: gitignore_global
      dest: .gitignore_global
    - src: ssh.config
      dest: .ssh/config
    - src: ssh.control
      dest: .gnupg/sshcontrol
    - src: config.fish
      dest: .config/fish/config.fish
    - src: database
      dest: .database
    - src: functions
      dest: .config/fish/functions
